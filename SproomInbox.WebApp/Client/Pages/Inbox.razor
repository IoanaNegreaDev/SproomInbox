@page "/inbox/{FilterParameters}"
@using SproomInbox.WebApp.Shared.Resources
@using System.Threading;
@inject HttpClient Http

@if (_documents != null)
{
    <p></p>
    <p>@_documents.Count documents. @_selectedIds.Count are selected.</p>

    <table class="table table-striped" align="left">
        <thead class="thead-light">
            <tr>             
                <th>Id</th>
                <th>Type</th>
                <th>Status</th>
                <th>Date</th>    
                <th></th>    
            </tr>
        </thead>
        <tbody>
            @foreach (var document in _documents)
            {
                <tr @onclick="() => _documentView[document.Id] = ! _documentView[document.Id]">
                    <td>
                        <input class="custom-control-input" id="customCheck"
                               type="checkbox" 
                               disabled=@IsDocumentFinalState(@document.State)                           
                               @onchange="eventArgs => { OnCheckboxClicked(document.Id, eventArgs.Value); }" 
                        />
                    </td>
                    <td>@document.Id</td>
                    <td>@document.Type</td>
                    <td>@document.State</td>
                    <td>@document.CreationDate.ToShortDateString()</td>
                 </tr>
                 @if (_documentView[document.Id])
                 {      
                     <td></td>
                       <table class="child-grid" cellpadding=5 align="left" >

                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var statusChange in document.StateHistory)
                            {
                                <tr>
                                    <td>@statusChange.Timestamp</td>
                                    <td>@statusChange.State</td>
                                </tr>
                            }
                       </tbody>
                    </table>                  
                 }
            }
        </tbody>
    </table>

    <p></p>

    <div class="span2">
        <button class="btn btn-primary border-radius: 30px alert-primary" @onclick="OnApprove"> Approve </button>
            &nbsp;
        <button class="btn btn-primary border-radius: 30px alert-primary" @onclick="OnReject"> Reject </button>
    </div>
} 
else {
    <p></p>
    <p><em>...</em></p>
}

@code
{

    
}